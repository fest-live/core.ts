// @ts-ignore
WeakMap.prototype.getOrInsert ??= function (key, defaultValue) {
    if (!this.has(key)) {
        this.set(key, defaultValue);
    }
    return this.get(key);
};
// @ts-ignore
WeakMap.prototype.getOrInsertComputed ??= function (key, callbackFunction) {
    if (!this.has(key)) {
        this.set(key, callbackFunction(key));
    }
    return this.get(key);
};
// @ts-ignore
Map.prototype.getOrInsert ??= function (key, defaultValue) {
    if (!this.has(key)) {
        this.set(key, defaultValue);
    }
    return this.get(key);
};
// @ts-ignore
Map.prototype.getOrInsertComputed ??= function (key, callbackFunction) {
    if (!this.has(key)) {
        this.set(key, callbackFunction(key));
    }
    return this.get(key);
};
/**
 * Get a value from a Map, or insert a default value if the key doesn't exist.
 * @template K - The key type
 * @template V - The value type
 * @param map - The Map to get or insert into
 * @param key - The key to look up
 * @param defaultValue - A function that returns the default value to insert if the key doesn't exist
 * @returns The value from the map (existing or newly inserted)
 */
export const getOrInsert = (map, key, defaultValue = () => null) => {
    if (!map?.has?.(key)) {
        map?.set?.(key, defaultValue?.());
    }
    return map?.get?.(key);
};
/**
 * Get a value from a Map, or insert a computed value if the key doesn't exist.
 * @template K - The key type
 * @template V - The value type
 * @param map - The Map to get or insert into
 * @param key - The key to look up
 * @param callbackFunction - A function that computes the value to insert based on the key
 * @returns The value from the map (existing or newly computed and inserted)
 */
export const getOrInsertComputed = (map, key, callbackFunction = () => null) => {
    if (!map?.has?.(key)) {
        map?.set?.(key, callbackFunction?.(key));
    }
    return map?.get?.(key);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVXBzZXJ0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVXBzZXJ0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLGFBQWE7QUFDYixPQUFPLENBQUMsU0FBUyxDQUFDLFdBQVcsS0FBSyxVQUFVLEdBQUcsRUFBRSxZQUFZO0lBQ3pELElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDcEQsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3pCLENBQUMsQ0FBQztBQUVGLGFBQWE7QUFDYixPQUFPLENBQUMsU0FBUyxDQUFDLG1CQUFtQixLQUFLLFVBQVUsR0FBRyxFQUFFLGdCQUFnQjtJQUNyRSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDN0QsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3pCLENBQUMsQ0FBQztBQUVGLGFBQWE7QUFDYixHQUFHLENBQUMsU0FBUyxDQUFDLFdBQVcsS0FBSyxVQUFVLEdBQUcsRUFBRSxZQUFZO0lBQ3JELElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDcEQsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3pCLENBQUMsQ0FBQztBQUVGLGFBQWE7QUFDYixHQUFHLENBQUMsU0FBUyxDQUFDLG1CQUFtQixLQUFLLFVBQVUsR0FBRyxFQUFFLGdCQUFnQjtJQUNqRSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDN0QsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3pCLENBQUMsQ0FBQztBQUVGOzs7Ozs7OztHQVFHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUFHLENBQU8sR0FBYyxFQUFFLEdBQU0sRUFBRSxlQUF3QixHQUFHLEVBQUUsQ0FBRSxJQUFxQixFQUFFLEVBQUU7SUFDOUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFBQyxDQUFDO0lBQzVELE9BQU8sR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBTSxDQUFDO0FBQ2hDLENBQUMsQ0FBQztBQUVGOzs7Ozs7OztHQVFHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sbUJBQW1CLEdBQUcsQ0FBTyxHQUFjLEVBQUUsR0FBTSxFQUFFLG1CQUFrQyxHQUFHLEVBQUUsQ0FBRSxJQUFxQixFQUFFLEVBQUU7SUFDaEksSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFBQyxDQUFDO0lBQ25FLE9BQU8sR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBTSxDQUFDO0FBQ2hDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuLy8gQHRzLWlnbm9yZVxuV2Vha01hcC5wcm90b3R5cGUuZ2V0T3JJbnNlcnQgPz89IGZ1bmN0aW9uIChrZXksIGRlZmF1bHRWYWx1ZSkge1xuICAgIGlmICghdGhpcy5oYXMoa2V5KSkgeyB0aGlzLnNldChrZXksIGRlZmF1bHRWYWx1ZSk7IH1cbiAgICByZXR1cm4gdGhpcy5nZXQoa2V5KTtcbn07XG5cbi8vIEB0cy1pZ25vcmVcbldlYWtNYXAucHJvdG90eXBlLmdldE9ySW5zZXJ0Q29tcHV0ZWQgPz89IGZ1bmN0aW9uIChrZXksIGNhbGxiYWNrRnVuY3Rpb24pIHtcbiAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHsgdGhpcy5zZXQoa2V5LCBjYWxsYmFja0Z1bmN0aW9uKGtleSkpOyB9XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGtleSk7XG59O1xuXG4vLyBAdHMtaWdub3JlXG5NYXAucHJvdG90eXBlLmdldE9ySW5zZXJ0ID8/PSBmdW5jdGlvbiAoa2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHsgdGhpcy5zZXQoa2V5LCBkZWZhdWx0VmFsdWUpOyB9XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGtleSk7XG59O1xuXG4vLyBAdHMtaWdub3JlXG5NYXAucHJvdG90eXBlLmdldE9ySW5zZXJ0Q29tcHV0ZWQgPz89IGZ1bmN0aW9uIChrZXksIGNhbGxiYWNrRnVuY3Rpb24pIHtcbiAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHsgdGhpcy5zZXQoa2V5LCBjYWxsYmFja0Z1bmN0aW9uKGtleSkpOyB9XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGtleSk7XG59O1xuXG4vKipcbiAqIEdldCBhIHZhbHVlIGZyb20gYSBNYXAsIG9yIGluc2VydCBhIGRlZmF1bHQgdmFsdWUgaWYgdGhlIGtleSBkb2Vzbid0IGV4aXN0LlxuICogQHRlbXBsYXRlIEsgLSBUaGUga2V5IHR5cGVcbiAqIEB0ZW1wbGF0ZSBWIC0gVGhlIHZhbHVlIHR5cGVcbiAqIEBwYXJhbSBtYXAgLSBUaGUgTWFwIHRvIGdldCBvciBpbnNlcnQgaW50b1xuICogQHBhcmFtIGtleSAtIFRoZSBrZXkgdG8gbG9vayB1cFxuICogQHBhcmFtIGRlZmF1bHRWYWx1ZSAtIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBkZWZhdWx0IHZhbHVlIHRvIGluc2VydCBpZiB0aGUga2V5IGRvZXNuJ3QgZXhpc3RcbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBmcm9tIHRoZSBtYXAgKGV4aXN0aW5nIG9yIG5ld2x5IGluc2VydGVkKVxuICovXG5leHBvcnQgY29uc3QgZ2V0T3JJbnNlcnQgPSA8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgZGVmYXVsdFZhbHVlOiAoKSA9PiBWID0gKCkgPT4gKG51bGwgYXMgdW5rbm93biBhcyBWKSkgPT4ge1xuICAgIGlmICghbWFwPy5oYXM/LihrZXkpKSB7IG1hcD8uc2V0Py4oa2V5LCBkZWZhdWx0VmFsdWU/LigpKTsgfVxuICAgIHJldHVybiBtYXA/LmdldD8uKGtleSkgYXMgVjtcbn07XG5cbi8qKlxuICogR2V0IGEgdmFsdWUgZnJvbSBhIE1hcCwgb3IgaW5zZXJ0IGEgY29tcHV0ZWQgdmFsdWUgaWYgdGhlIGtleSBkb2Vzbid0IGV4aXN0LlxuICogQHRlbXBsYXRlIEsgLSBUaGUga2V5IHR5cGVcbiAqIEB0ZW1wbGF0ZSBWIC0gVGhlIHZhbHVlIHR5cGVcbiAqIEBwYXJhbSBtYXAgLSBUaGUgTWFwIHRvIGdldCBvciBpbnNlcnQgaW50b1xuICogQHBhcmFtIGtleSAtIFRoZSBrZXkgdG8gbG9vayB1cFxuICogQHBhcmFtIGNhbGxiYWNrRnVuY3Rpb24gLSBBIGZ1bmN0aW9uIHRoYXQgY29tcHV0ZXMgdGhlIHZhbHVlIHRvIGluc2VydCBiYXNlZCBvbiB0aGUga2V5XG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgZnJvbSB0aGUgbWFwIChleGlzdGluZyBvciBuZXdseSBjb21wdXRlZCBhbmQgaW5zZXJ0ZWQpXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRPckluc2VydENvbXB1dGVkID0gPEssIFY+KG1hcDogTWFwPEssIFY+LCBrZXk6IEssIGNhbGxiYWNrRnVuY3Rpb246IChrZXk6IEspID0+IFYgPSAoKSA9PiAobnVsbCBhcyB1bmtub3duIGFzIFYpKSA9PiB7XG4gICAgaWYgKCFtYXA/Lmhhcz8uKGtleSkpIHsgbWFwPy5zZXQ/LihrZXksIGNhbGxiYWNrRnVuY3Rpb24/LihrZXkpKTsgfVxuICAgIHJldHVybiBtYXA/LmdldD8uKGtleSkgYXMgVjtcbn07XG4iXX0=