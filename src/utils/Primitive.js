export const $fxy = Symbol.for("@fix");
//
export const isHasPrimitives = (observable) => {
    return observable?.some?.(isPrimitive);
};
//
export const isObservable = (observable) => {
    return Array.isArray(observable) || observable instanceof Set || observable instanceof Map;
};
/**
 * Check if a value is a primitive type (null, string, number, boolean, bigint, or undefined).
 * @param obj - The value to check
 * @returns True if the value is a primitive type, false otherwise
 */
export const isPrimitive = (obj) => {
    return typeof obj == "string" || typeof obj == "number" || typeof obj == "boolean" || typeof obj == "bigint" || typeof obj == "undefined" || obj == null;
};
//
export const tryParseByHint = (value, hint) => {
    if (!isPrimitive(value))
        return null;
    if (hint == "number") {
        return Number(value) || 0;
    }
    if (hint == "string") {
        return String(value) || "";
    }
    if (hint == "boolean") {
        return !!value;
    }
    return value;
};
//
export const hasProperty = (v, prop = "value") => {
    return ((typeof v == "object" || typeof v == "function") && v != null && ((prop in v) || v?.[prop] != null));
};
//
export const hasValue = (v) => { return hasProperty(v, "value"); };
//
export const $getValue = ($objOrPlain) => {
    if (isPrimitive($objOrPlain))
        return $objOrPlain;
    return hasValue($objOrPlain) ? $objOrPlain?.value : $objOrPlain;
};
//
export const unwrap = (obj, fallback) => {
    return (obj?.[$fxy] ?? (fallback ?? obj));
};
//
export const deref = (obj) => {
    if (obj != null && (typeof obj == "object" || typeof obj == "function") && (obj instanceof WeakRef || typeof obj?.deref == "function")) {
        return deref(obj?.deref?.());
    }
    ;
    return obj;
};
//
export const fixFx = (obj) => { if (typeof obj == "function" || obj == null)
    return obj; const fx = function () { }; fx[$fxy] = obj; return fx; };
export const $set = (rv, key, val) => {
    rv = deref(rv);
    if (rv != null && (typeof rv == "object" || typeof rv == "function")) {
        return (rv[key] = $getValue(val = deref(val)));
    }
    ;
    return rv;
};
//
export const getRandomValues = (array) => {
    return crypto?.getRandomValues ? crypto?.getRandomValues?.(array) : (() => {
        const values = new Uint8Array(array.length);
        for (let i = 0; i < array.length; i++) {
            values[i] = Math.floor(Math.random() * 256);
        }
        return values;
    })();
};
//
export const clamp = (min, val, max) => Math.max(min, Math.min(val, max));
export const withCtx = (target, got) => { if (typeof got == "function") {
    return got?.bind?.(target) ?? got;
} ; return got; };
//
export const UUIDv4 = () => (crypto?.randomUUID ? crypto?.randomUUID?.() : ("10000000-1000-4000-8000-100000000000".replace(/[018]/g, c => (+c ^ (getRandomValues?.(new Uint8Array(1))?.[0] & (15 >> (+c / 4)))).toString(16))));
//
export const camelToKebab = (str) => { if (!str)
    return str; return str?.replace?.(/([a-z])([A-Z])/g, '$1-$2').toLowerCase(); };
export const kebabToCamel = (str) => { if (!str)
    return str; return str?.replace?.(/-([a-z])/g, (_, char) => char.toUpperCase()); };
//
export const toFiniteNumber = (value, fallback = 0) => {
    const number = Number(value);
    return Number.isFinite(number) ? number : fallback;
};
//
export const clampDimension = (value, max) => {
    if (!Number.isFinite(max) || max <= 0) {
        return 0;
    }
    if (!Number.isFinite(value)) {
        return 0;
    }
    return Math.min(Math.max(value, 0), max);
};
//
export const roundNearest = (number, N = 1) => (Math.round(number * N) / N);
export const floorNearest = (number, N = 1) => (Math.floor(number * N) / N);
export const ceilNearest = (number, N = 1) => (Math.ceil(number * N) / N);
//
export const isValueUnit = (val) => (typeof CSSStyleValue !== "undefined" && val instanceof CSSStyleValue);
export const isVal = (v) => v != null && (typeof v == "boolean" ? v !== false : true) && (typeof v != "object" && typeof v != "function");
//
export const normalizePrimitive = (val) => {
    return (typeof val == "boolean" ? (val ? "" : null) : (typeof val == "number" ? String(val) : val));
};
//
export const $triggerLock = Symbol.for("@trigger-lock");
export const $avoidTrigger = (ref, cb, $prop = "value") => {
    if (hasProperty(ref, $prop))
        ref[$triggerLock] = true;
    let result;
    try {
        result = cb?.();
    }
    finally {
        if (hasProperty(ref, $prop)) {
            delete ref[$triggerLock];
        }
    }
    return result;
};
//
export const tryStringAsNumber = (val) => {
    if (typeof val != "string")
        return null;
    const matches = [...val?.matchAll?.(/^\d+(\.\d+)?$/g)];
    if (matches?.length != 1)
        return null;
    const triedToParse = parseFloat(matches[0][0]);
    if (!Number.isNaN(triedToParse) && Number.isFinite(triedToParse)) {
        return triedToParse;
    }
    ;
    return null;
};
//
export const INTEGER_REGEXP = /^\d+$/g;
//
export const tryStringAsInteger = (val) => {
    if (typeof val != "string")
        return null;
    val = val?.trim?.();
    if (val == "" || val == null)
        return null;
    const matches = [...val?.matchAll?.(INTEGER_REGEXP)];
    if (matches?.length != 1)
        return null;
    const triedToParse = parseInt(matches[0][0]);
    if (!Number.isNaN(triedToParse) && Number.isInteger(triedToParse)) {
        return triedToParse;
    }
    ;
    return null;
};
//
export const isValidNumber = (val) => {
    return typeof val == "number" && !Number.isNaN(val);
};
//
export const canBeInteger = (value) => {
    if (typeof value == "string") {
        return tryStringAsInteger(value) != null;
    }
    else
        return typeof value == "number" && Number.isInteger(value) && value >= 0;
};
//
export const isArrayOrIterable = (obj) => Array.isArray(obj) || (obj != null && typeof obj == "object" && typeof obj[Symbol.iterator] == "function");
export const handleListeners = (root, fn, handlers) => { root = (root instanceof WeakRef ? root.deref() : root); const usubs = [...Object.entries(handlers)]?.map?.(([name, cb]) => root?.[fn]?.call?.(root, name, cb)); return () => { usubs?.forEach?.((unsub) => unsub?.()); }; };
//
export const isRef = (ref) => { return ref instanceof WeakRef || typeof ref?.deref == "function"; };
export const unref = (ref) => { return isRef(ref) ? deref(ref) : ref; };
export const toRef = (ref) => { return ref != null ? (isRef(ref) ? ref : ((typeof ref == "function" || typeof ref == "object") ? new WeakRef(ref) : ref)) : ref; };
//
export const isValueRef = (exists) => {
    return (typeof exists == "object" || typeof exists == "function") && (exists?.value != null || (exists != null && "value" in exists));
};
//
export const isObject = (exists) => {
    return exists != null && (typeof exists == "object" || typeof exists == "function");
};
/**
 * Get the value from a value reference or return the value itself.
 * @param val - The value or value reference to extract from
 * @returns The extracted value
 */
export const getValue = (val) => {
    return (hasValue(val) ? val?.value : val);
};
//
export const potentiallyAsync = (promise, cb) => {
    if (promise instanceof Promise || typeof promise?.then == "function") {
        return promise?.then?.(cb);
    }
    else {
        return cb?.(promise);
    }
    return promise;
};
//
export const potentiallyAsyncMap = (promise, cb) => {
    if (promise instanceof Promise || typeof promise?.then == "function") {
        return promise?.then?.(cb);
    }
    else {
        return cb?.(promise);
    }
    return promise;
};
//
export const makeTriggerLess = function (self) {
    return (cb) => {
        self[$triggerLock] = true;
        let result;
        try {
            result = cb?.();
        }
        finally {
            self[$triggerLock] = false;
        }
        return result;
    };
};
//
export const unwrapArray = (arr) => {
    if (Array.isArray(arr)) {
        return arr?.flatMap?.((el) => {
            if (Array.isArray(el))
                return unwrapArray(el);
            return el;
        });
    }
    else {
        return arr;
    }
};
/*
//
export const isNotComplexArray = (arr: any[])=>{
    return unwrapArray(arr).every(isPrimitive);
}*/
//
export const isNotComplexArray = (arr) => {
    return unwrapArray(arr)?.every?.(isCanJustReturn);
};
// TODO: review cases when arrays isn't primitive
export const isCanJustReturn = (obj) => {
    return isPrimitive(obj) || (typeof SharedArrayBuffer == "function" && obj instanceof SharedArrayBuffer) || isTypedArray(obj) || (Array.isArray(obj) && isNotComplexArray(obj));
};
//
export const isTypedArray = (value) => {
    return ArrayBuffer.isView(value) && !(value instanceof DataView);
};
//
export const isSymbol = (sym) => (typeof sym === 'symbol' || typeof sym == 'object' && Object.prototype.toString.call(sym) == '[object Symbol]');
export const isPromise = (target) => {
    return target instanceof Promise || typeof target?.then == "function";
};
//
export const isCanTransfer = (obj) => {
    return isPrimitive(obj) ||
        (typeof ArrayBuffer == "function" && obj instanceof ArrayBuffer) ||
        (typeof MessagePort == "function" && obj instanceof MessagePort) ||
        (typeof ReadableStream == "function" && obj instanceof ReadableStream) ||
        (typeof WritableStream == "function" && obj instanceof WritableStream) ||
        (typeof TransformStream == "function" && obj instanceof TransformStream) ||
        (typeof ImageBitmap == "function" && obj instanceof ImageBitmap) ||
        (typeof VideoFrame == "function" && obj instanceof VideoFrame) ||
        (typeof OffscreenCanvas == "function" && obj instanceof OffscreenCanvas) ||
        (typeof RTCDataChannel == "function" && obj instanceof RTCDataChannel) || // @ts-ignore
        (typeof AudioData == "function" && obj instanceof AudioData) || // @ts-ignore
        (typeof WebTransportReceiveStream == "function" && obj instanceof WebTransportReceiveStream) || // @ts-ignore
        (typeof WebTransportSendStream == "function" && obj instanceof WebTransportSendStream) || // @ts-ignore
        (typeof WebTransportReceiveStream == "function" && obj instanceof WebTransportReceiveStream); // @ts-ignore
};
//
export const defaultByType = (a) => {
    switch (typeof a) {
        case "number": return 0;
        case "string": return "";
        case "boolean": return false;
        case "object": return null;
        case "function": return null;
        case "symbol": return null;
        case "bigint": return 0n;
    }
    return undefined;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJpbWl0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiUHJpbWl0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sQ0FBQyxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBRXZDLEVBQUU7QUFDRixNQUFNLENBQUMsTUFBTSxlQUFlLEdBQUcsQ0FBQyxVQUFlLEVBQUUsRUFBRTtJQUMvQyxPQUFPLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUMzQyxDQUFDLENBQUE7QUFFRCxFQUFFO0FBQ0YsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsVUFBZSxFQUFFLEVBQUU7SUFDNUMsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFVBQVUsWUFBWSxHQUFHLElBQUksVUFBVSxZQUFZLEdBQUcsQ0FBQztBQUMvRixDQUFDLENBQUM7QUFFRjs7OztHQUlHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUFHLENBQUMsR0FBUSxFQUFDLEVBQUU7SUFDbkMsT0FBTyxPQUFPLEdBQUcsSUFBSSxRQUFRLElBQUksT0FBTyxHQUFHLElBQUksUUFBUSxJQUFJLE9BQU8sR0FBRyxJQUFJLFNBQVMsSUFBSSxPQUFPLEdBQUcsSUFBSSxRQUFRLElBQUksT0FBTyxHQUFHLElBQUksV0FBVyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUM7QUFDN0osQ0FBQyxDQUFBO0FBRUQsRUFBRTtBQUNGLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxDQUFDLEtBQVUsRUFBRSxJQUFVLEVBQUMsRUFBRTtJQUNwRCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQztRQUFFLE9BQU8sSUFBSSxDQUFDO0lBQ3JDLElBQUksSUFBSSxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQUMsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lB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LENBQUMsSUFBSSxHQUFHLENBQUM7QUFBQyxDQUFDLENBQUEsQ0FBQyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBRTNILEVBQUU7QUFDRixNQUFNLENBQUMsTUFBTSxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxzQ0FBc0MsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUVoTyxFQUFFO0FBQ0YsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsR0FBRztJQUFFLE9BQU8sR0FBRyxDQUFDLENBQUMsT0FBTyxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsaUJBQWlCLEVBQUUsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDdkksTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsR0FBRztJQUFFLE9BQU8sR0FBRyxDQUFDLENBQUMsT0FBTyxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFFM0ksRUFBRTtBQUNGLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxDQUFDLEtBQVUsRUFBRSxRQUFRLEdBQUcsQ0FBQyxFQUFFLEVBQUU7SUFDdkQsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzdCLE9BQU8sTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDdkQsQ0FBQyxDQUFDO0FBRUYsRUFBRTtBQUNGLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxDQUFDLEtBQWEsRUFBRSxHQUFXLEVBQUUsRUFBRTtJQUN6RCxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7UUFBQyxPQUFPLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDcEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQUMsQ0FBQztJQUMxQyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDN0MsQ0FBQyxDQUFDO0FBRUYsRUFBRTtBQUNGLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxDQUFDLE1BQWMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzVGLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxDQUFDLE1BQWMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzVGLE1BQU0sQ0FBQyxNQUFNLFdBQVcsR0FBRyxDQUFDLE1B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QUFLLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3hHLE1BQU0sQ0FBQyxNQUFNLEtBQUssR0FBRyxDQUFDLEdBQVEsRUFBRSxFQUFFLEdBQUcsT0FBTyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzVFLE1BQU0sQ0FBQyxNQUFNLEtBQUssR0FBRyxDQUFDLEdBQVEsRUFBRSxFQUFFLEdBQUcsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxHQUFHLElBQUksVUFBVSxJQUFJLE9BQU8sR0FBRyxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBRXZLLEVBQUU7QUFDRixNQUFNLENBQUMsTUFBTSxVQUFVLEdBQUcsQ0FBQyxNQUFNLEVBQUUsRUFBRTtJQUNqQyxPQUFPLENBQUMsT0FBTyxNQUFNLElBQUksUUFBUSxJQUFJLE9BQU8sTUFBTSxJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxJQUFJLE9BQU8sSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFBO0FBQ3pJLENBQUMsQ0FBQTtBQUVELEVBQUU7QUFDRixNQUFNLENBQUMsTUFBTSxRQUFRLEdBQUcsQ0FBQyxNQUFNLEVBQUUsRUFBRTtJQUMvQixPQUFPLE1BQU0sSUFBSSxJQUFJLElBQUksQ0FBQyxPQUFPLE1BQU0sSUFBSSxRQUFRLElBQUksT0FBTyxNQUFNLElBQUksVUFBVSxDQUFDLENBQUM7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LElBQUksQ0FBQztRQUMzQixLQUFLLFFBQVEsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFDRCxPQUFPLFNBQVMsQ0FBQztBQUNyQixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgJGZ4eSA9IFN5bWJvbC5mb3IoXCJAZml4XCIpO1xuXG4vL1xuZXhwb3J0IGNvbnN0IGlzSGFzUHJpbWl0aXZlcyA9IChvYnNlcnZhYmxlOiBhbnkpID0+IHtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZT8uc29tZT8uKGlzUHJpbWl0aXZlKTtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBpc09ic2VydmFibGUgPSAob2JzZXJ2YWJsZTogYW55KSA9PiB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkob2JzZXJ2YWJsZSkgfHwgb2JzZXJ2YWJsZSBpbnN0YW5jZW9mIFNldCB8fCBvYnNlcnZhYmxlIGluc3RhbmNlb2YgTWFwO1xufTtcblxuLyoqXG4gKiBDaGVjayBpZiBhIHZhbHVlIGlzIGEgcHJpbWl0aXZlIHR5cGUgKG51bGwsIHN0cmluZywgbnVtYmVyLCBib29sZWFuLCBiaWdpbnQsIG9yIHVuZGVmaW5lZCkuXG4gKiBAcGFyYW0gb2JqIC0gVGhlIHZhbHVlIHRvIGNoZWNrXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBhIHByaW1pdGl2ZSB0eXBlLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGNvbnN0IGlzUHJpbWl0aXZlID0gKG9iajogYW55KT0+e1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09IFwic3RyaW5nXCIgfHwgdHlwZW9mIG9iaiA9PSBcIm51bWJlclwiIHx8IHR5cGVvZiBvYmogPT0gXCJib29sZWFuXCIgfHwgdHlwZW9mIG9iaiA9PSBcImJpZ2ludFwiIHx8IHR5cGVvZiBvYmogPT0gXCJ1bmRlZmluZWRcIiB8fCBvYmogPT0gbnVsbDtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCB0cnlQYXJzZUJ5SGludCA9ICh2YWx1ZTogYW55LCBoaW50PzogYW55KT0+e1xuICAgIGlmICghaXNQcmltaXRpdmUodmFsdWUpKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoaGludCA9PSBcIm51bWJlclwiKSB7IHJldHVybiBOdW1iZXIodmFsdWUpIHx8IDA7IH1cbiAgICBpZiAoaGludCA9PSBcInN0cmluZ1wiKSB7IHJldHVybiBTdHJpbmcodmFsdWUpIHx8IFwiXCI7IH1cbiAgICBpZiAoaGludCA9PSBcImJvb2xlYW5cIikgeyByZXR1cm4gISF2YWx1ZTsgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBoYXNQcm9wZXJ0eSA9ICh2OiBhbnksIHByb3A6IHN0cmluZyA9IFwidmFsdWVcIikgPT4ge1xuICAgIHJldHVybiAoKHR5cGVvZiB2ID09IFwib2JqZWN0XCIgfHwgdHlwZW9mIHYgPT0gXCJmdW5jdGlvblwiKSAmJiB2ICE9IG51bGwgJiYgKChwcm9wIGluIHYpIHx8IHY/Lltwcm9wXSAhPSBudWxsKSk7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgaGFzVmFsdWUgPSAodjogYW55KSA9PiB7IHJldHVybiBoYXNQcm9wZXJ0eSh2LCBcInZhbHVlXCIpOyB9XG5cbi8vXG5leHBvcnQgY29uc3QgJGdldFZhbHVlID0gKCRvYmpPclBsYWluOiBhbnkpID0+IHtcbiAgICBpZiAoaXNQcmltaXRpdmUoJG9iak9yUGxhaW4pKSByZXR1cm4gJG9iak9yUGxhaW47XG4gICAgcmV0dXJuIGhhc1ZhbHVlKCRvYmpPclBsYWluKSA/ICRvYmpPclBsYWluPy52YWx1ZSA6ICRvYmpPclBsYWluO1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0IHVud3JhcCA9IChvYmosIGZhbGxiYWNrPzogbnVsbHx1bmRlZmluZWR8KCguLi5hcmdzOiBhbnlbXSk9PmFueSkpPT57XG4gICAgcmV0dXJuIChvYmo/LlskZnh5XSA/PyAoZmFsbGJhY2sgPz8gb2JqKSk7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgZGVyZWYgPSAob2JqOiBhbnkpID0+IHtcbiAgICBpZiAob2JqICE9IG51bGwgJiYgKHR5cGVvZiBvYmogPT0gXCJvYmplY3RcIiB8fCB0eXBlb2Ygb2JqID09IFwiZnVuY3Rpb25cIikgJiYgKG9iaiBpbnN0YW5jZW9mIFdlYWtSZWYgfHwgdHlwZW9mIG9iaj8uZGVyZWYgPT0gXCJmdW5jdGlvblwiKSkge1xuICAgICAgICByZXR1cm4gZGVyZWYob2JqPy5kZXJlZj8uKCkpO1xuICAgIH07XG4gICAgcmV0dXJuIG9iajtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBmaXhGeCA9IChvYmopID0+IHsgaWYgKHR5cGVvZiBvYmogPT0gXCJmdW5jdGlvblwiIHx8IG9iaiA9PSBudWxsKSByZXR1cm4gb2JqOyBjb25zdCBmeCA9IGZ1bmN0aW9uKCl7fTsgZnhbJGZ4eV0gPSBvYmo7IHJldHVybiBmeDsgfVxuZXhwb3J0IGNvbnN0ICRzZXQgPSAocnYsIGtleSwgdmFsKT0+e1xuICAgIHJ2ID0gZGVyZWYocnYpO1xuICAgIGlmIChydiAhPSBudWxsICYmICh0eXBlb2YgcnYgPT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgcnYgPT0gXCJmdW5jdGlvblwiKSkge1xuICAgICAgICByZXR1cm4gKHJ2W2tleV0gPSAkZ2V0VmFsdWUodmFsID0gZGVyZWYodmFsKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIHJ2O1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0IGdldFJhbmRvbVZhbHVlcyA9IChhcnJheTogVWludDhBcnJheSkgPT4geyByZXR1cm4gY3J5cHRvPy5nZXRSYW5kb21WYWx1ZXMgPyBjcnlwdG8/LmdldFJhbmRvbVZhbHVlcz8uKGFycmF5KSA6ICgoKT0+e1xuICAgIGNvbnN0IHZhbHVlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5Lmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YWx1ZXNbaV0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyNTYpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVzO1xufSkoKTsgfTtcblxuLy9cbmV4cG9ydCBjb25zdCBjbGFtcCAgPSAobWluLCB2YWwsIG1heCkgPT4gTWF0aC5tYXgobWluLCBNYXRoLm1pbih2YWwsIG1heCkpO1xuZXhwb3J0IGNvbnN0IHdpdGhDdHggPSAodGFyZ2V0LCBnb3QpPT57IGlmICh0eXBlb2YgZ290ID09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4gZ290Py5iaW5kPy4odGFyZ2V0KSA/PyBnb3Q7IH07IHJldHVybiBnb3Q7IH1cblxuLy9cbmV4cG9ydCBjb25zdCBVVUlEdjQgPSAoKSA9PiAoY3J5cHRvPy5yYW5kb21VVUlEID8gY3J5cHRvPy5yYW5kb21VVUlEPy4oKSA6IChcIjEwMDAwMDAwLTEwMDAtNDAwMC04MDAwLTEwMDAwMDAwMDAwMFwiLnJlcGxhY2UoL1swMThdL2csIGMgPT4gKCtjIF4gKGdldFJhbmRvbVZhbHVlcz8uKG5ldyBVaW50OEFycmF5KDEpKT8uWzBdICYgKDE1ID4+ICgrYyAvIDQpKSkpLnRvU3RyaW5nKDE2KSkpKTtcblxuLy9cbmV4cG9ydCBjb25zdCBjYW1lbFRvS2ViYWIgPSAoc3RyOiBzdHJpbmcpID0+IHsgaWYgKCFzdHIpIHJldHVybiBzdHI7IHJldHVybiBzdHI/LnJlcGxhY2U/LigvKFthLXpdKShbQS1aXSkvZywgJyQxLSQyJykudG9Mb3dlckNhc2UoKTsgfVxuZXhwb3J0IGNvbnN0IGtlYmFiVG9DYW1lbCA9IChzdHI6IHN0cmluZykgPT4geyBpZiAoIXN0cikgcmV0dXJuIHN0cjsgcmV0dXJuIHN0cj8ucmVwbGFjZT8uKC8tKFthLXpdKS9nLCAoXywgY2hhcikgPT4gY2hhci50b1VwcGVyQ2FzZSgpKTsgfVxuXG4vL1xuZXhwb3J0IGNvbnN0IHRvRmluaXRlTnVtYmVyID0gKHZhbHVlOiBhbnksIGZhbGxiYWNrID0gMCkgPT4ge1xuICAgIGNvbnN0IG51bWJlciA9IE51bWJlcih2YWx1ZSk7XG4gICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShudW1iZXIpID8gbnVtYmVyIDogZmFsbGJhY2s7XG59O1xuXG4vL1xuZXhwb3J0IGNvbnN0IGNsYW1wRGltZW5zaW9uID0gKHZhbHVlOiBudW1iZXIsIG1heDogbnVtYmVyKSA9PiB7XG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUobWF4KSB8fCBtYXggPD0gMCkgeyByZXR1cm4gMDsgfVxuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKHZhbHVlKSkgeyByZXR1cm4gMDsgfVxuICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgMCksIG1heCk7XG59O1xuXG4vL1xuZXhwb3J0IGNvbnN0IHJvdW5kTmVhcmVzdCA9IChudW1iZXI6IG51bWJlciwgTiA9IDEpOiBudW1iZXIgPT4gKE1hdGgucm91bmQobnVtYmVyICogTikgLyBOKTtcbmV4cG9ydCBjb25zdCBmbG9vck5lYXJlc3QgPSAobnVtYmVyOiBudW1iZXIsIE4gPSAxKTogbnVtYmVyID0+IChNYXRoLmZsb29yKG51bWJlciAqIE4pIC8gTik7XG5leHBvcnQgY29uc3QgY2VpbE5lYXJlc3QgPSAobnVtYmVyOiBudW1iZXIsIE4gPSAxKTogbnVtYmVyID0+IChNYXRoLmNlaWwobnVtYmVyICogTikgLyBOKTtcblxuLy9cbmV4cG9ydCBjb25zdCBpc1ZhbHVlVW5pdCA9ICh2YWw6IGFueSkgPT4gKHR5cGVvZiBDU1NTdHlsZVZhbHVlICE9PSBcInVuZGVmaW5lZFwiICYmIHZhbCBpbnN0YW5jZW9mIENTU1N0eWxlVmFsdWUpO1xuZXhwb3J0IGNvbnN0IGlzVmFsID0gKHY6IGFueSkgPT4gdiAhPSBudWxsICYmICh0eXBlb2YgdiA9PSBcImJvb2xlYW5cIiA/IHYgIT09IGZhbHNlIDogdHJ1ZSkgJiYgKHR5cGVvZiB2ICE9IFwib2JqZWN0XCIgJiYgdHlwZW9mIHYgIT0gXCJmdW5jdGlvblwiKTtcbmV4cG9ydCB0eXBlIERhdGFzZXRWYWx1ZSA9IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkIHwgeyB2YWx1ZT86IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkIH07XG5cbi8vXG5leHBvcnQgY29uc3Qgbm9ybWFsaXplUHJpbWl0aXZlID0gKHZhbDogYW55KSA9PiB7XG4gICAgcmV0dXJuICh0eXBlb2YgdmFsID09IFwiYm9vbGVhblwiID8gKHZhbCA/IFwiXCIgOiBudWxsKSA6ICh0eXBlb2YgdmFsID09IFwibnVtYmVyXCIgPyBTdHJpbmcodmFsKSA6IHZhbCkpO1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0ICR0cmlnZ2VyTG9jayAgPSBTeW1ib2wuZm9yKFwiQHRyaWdnZXItbG9ja1wiKTtcbmV4cG9ydCBjb25zdCAkYXZvaWRUcmlnZ2VyID0gKHJlZjogYW55LCBjYjogKCk9PmFueSwgJHByb3A6IHN0cmluZyA9IFwidmFsdWVcIik9PntcbiAgICBpZiAoaGFzUHJvcGVydHkocmVmLCAkcHJvcCkpIHJlZlskdHJpZ2dlckxvY2tdID0gdHJ1ZTtcbiAgICBsZXQgcmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIHJlc3VsdCA9IGNiPy4oKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgICBpZiAoaGFzUHJvcGVydHkocmVmLCAkcHJvcCkpIHsgZGVsZXRlIHJlZlskdHJpZ2dlckxvY2tdOyB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgdHJ5U3RyaW5nQXNOdW1iZXIgPSAodmFsOiBzdHJpbmcpOiBudW1iZXIgfCBudWxsID0+IHtcbiAgICBpZiAodHlwZW9mIHZhbCAhPSBcInN0cmluZ1wiKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBtYXRjaGVzID0gWy4uLnZhbD8ubWF0Y2hBbGw/LigvXlxcZCsoXFwuXFxkKyk/JC9nKV07XG4gICAgaWYgKG1hdGNoZXM/Lmxlbmd0aCAhPSAxKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCB0cmllZFRvUGFyc2UgPSBwYXJzZUZsb2F0KG1hdGNoZXNbMF1bMF0pO1xuICAgIGlmICghTnVtYmVyLmlzTmFOKHRyaWVkVG9QYXJzZSkgJiYgTnVtYmVyLmlzRmluaXRlKHRyaWVkVG9QYXJzZSkpIHsgcmV0dXJuIHRyaWVkVG9QYXJzZTsgfTtcbiAgICByZXR1cm4gbnVsbDtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBJTlRFR0VSX1JFR0VYUCA9IC9eXFxkKyQvZztcblxuLy9cbmV4cG9ydCBjb25zdCB0cnlTdHJpbmdBc0ludGVnZXIgPSAodmFsOiBzdHJpbmcpOiBudW1iZXIgfCBudWxsID0+IHtcbiAgICBpZiAodHlwZW9mIHZhbCAhPSBcInN0cmluZ1wiKSByZXR1cm4gbnVsbDtcbiAgICB2YWwgPSB2YWw/LnRyaW0/LigpOyBpZiAodmFsID09IFwiXCIgfHwgdmFsID09IG51bGwpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4udmFsPy5tYXRjaEFsbD8uKElOVEVHRVJfUkVHRVhQKV07XG4gICAgaWYgKG1hdGNoZXM/Lmxlbmd0aCAhPSAxKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCB0cmllZFRvUGFyc2UgPSBwYXJzZUludChtYXRjaGVzWzBdWzBdKTtcbiAgICBpZiAoIU51bWJlci5pc05hTih0cmllZFRvUGFyc2UpICYmIE51bWJlci5pc0ludGVnZXIodHJpZWRUb1BhcnNlKSkgeyByZXR1cm4gdHJpZWRUb1BhcnNlOyB9O1xuICAgIHJldHVybiBudWxsO1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0IGlzVmFsaWROdW1iZXIgPSAodmFsOiBhbnkpID0+IHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbCA9PSBcIm51bWJlclwiICYmICFOdW1iZXIuaXNOYU4odmFsKTtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBjYW5CZUludGVnZXIgPSAodmFsdWU6IGFueSkgPT4ge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdHJ5U3RyaW5nQXNJbnRlZ2VyKHZhbHVlKSAhPSBudWxsO1xuICAgIH0gZWxzZVxuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09IFwibnVtYmVyXCIgJiYgTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgdmFsdWUgPj0gMDtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBpc0FycmF5T3JJdGVyYWJsZSA9IChvYmopID0+IEFycmF5LmlzQXJyYXkob2JqKSB8fCAob2JqICE9IG51bGwgJiYgdHlwZW9mIG9iaiA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmpbU3ltYm9sLml0ZXJhdG9yXSA9PSBcImZ1bmN0aW9uXCIpO1xuZXhwb3J0IGNvbnN0IGhhbmRsZUxpc3RlbmVycyA9IChyb290OiBhbnksIGZuOiBzdHJpbmcsIGhhbmRsZXJzOiBhbnkpID0+IHsgcm9vdCA9IChyb290IGluc3RhbmNlb2YgV2Vha1JlZiA/IHJvb3QuZGVyZWYoKSA6IHJvb3QpOyBjb25zdCB1c3VicyA9IFsuLi5PYmplY3QuZW50cmllcyhoYW5kbGVycyldPy5tYXA/LigoW25hbWUsIGNiXSkgPT4gcm9vdD8uW2ZuXT8uY2FsbD8uKHJvb3QsIG5hbWUsIGNiKSk7IHJldHVybiAoKT0+eyB1c3Vicz8uZm9yRWFjaD8uKCh1bnN1Yik9PnVuc3ViPy4oKSk7IH07IH1cblxuLy9cbmV4cG9ydCBjb25zdCBpc1JlZiA9IChyZWY6IGFueSkgPT4geyByZXR1cm4gcmVmIGluc3RhbmNlb2YgV2Vha1JlZiB8fCB0eXBlb2YgcmVmPy5kZXJlZiA9PSBcImZ1bmN0aW9uXCI7IH1cbmV4cG9ydCBjb25zdCB1bnJlZiA9IChyZWY6IGFueSkgPT4geyByZXR1cm4gaXNSZWYocmVmKSA/IGRlcmVmKHJlZikgOiByZWY7IH1cbmV4cG9ydCBjb25zdCB0b1JlZiA9IChyZWY6IGFueSkgPT4geyByZXR1cm4gcmVmICE9IG51bGwgPyAoaXNSZWYocmVmKSA/IHJlZiA6ICgodHlwZW9mIHJlZiA9PSBcImZ1bmN0aW9uXCIgfHwgdHlwZW9mIHJlZiA9PSBcIm9iamVjdFwiKSA/IG5ldyBXZWFrUmVmKHJlZikgOiByZWYpKSA6IHJlZjsgfVxuXG4vL1xuZXhwb3J0IGNvbnN0IGlzVmFsdWVSZWYgPSAoZXhpc3RzKSA9PiB7XG4gICAgcmV0dXJuICh0eXBlb2YgZXhpc3RzID09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGV4aXN0cyA9PSBcImZ1bmN0aW9uXCIpICYmIChleGlzdHM/LnZhbHVlICE9IG51bGwgfHwgKGV4aXN0cyAhPSBudWxsICYmIFwidmFsdWVcIiBpbiBleGlzdHMpKVxufVxuXG4vL1xuZXhwb3J0IGNvbnN0IGlzT2JqZWN0ID0gKGV4aXN0cykgPT4ge1xuICAgIHJldHVybiBleGlzdHMgIT0gbnVsbCAmJiAodHlwZW9mIGV4aXN0cyA9PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBleGlzdHMgPT0gXCJmdW5jdGlvblwiKTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHZhbHVlIGZyb20gYSB2YWx1ZSByZWZlcmVuY2Ugb3IgcmV0dXJuIHRoZSB2YWx1ZSBpdHNlbGYuXG4gKiBAcGFyYW0gdmFsIC0gVGhlIHZhbHVlIG9yIHZhbHVlIHJlZmVyZW5jZSB0byBleHRyYWN0IGZyb21cbiAqIEByZXR1cm5zIFRoZSBleHRyYWN0ZWQgdmFsdWVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFZhbHVlID0gKHZhbDogYW55KSA9PiB7XG4gICAgcmV0dXJuIChoYXNWYWx1ZSh2YWwpID8gdmFsPy52YWx1ZSA6IHZhbCk7XG59XG5cblxuXG4vL1xuZXhwb3J0IGNvbnN0IHBvdGVudGlhbGx5QXN5bmMgPSAocHJvbWlzZSwgY2IpPT57XG4gICAgaWYgKHByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlIHx8IHR5cGVvZiBwcm9taXNlPy50aGVuID09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgeyByZXR1cm4gcHJvbWlzZT8udGhlbj8uKGNiKTsgfSBlbHNlXG4gICAgICAgIHsgcmV0dXJuIGNiPy4ocHJvbWlzZSk7IH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBwb3RlbnRpYWxseUFzeW5jTWFwID0gKHByb21pc2UsIGNiKT0+e1xuICAgIGlmIChwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSB8fCB0eXBlb2YgcHJvbWlzZT8udGhlbiA9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgIHsgcmV0dXJuIHByb21pc2U/LnRoZW4/LihjYik7IH0gZWxzZVxuICAgICAgICB7IHJldHVybiBjYj8uKHByb21pc2UpOyB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgbWFrZVRyaWdnZXJMZXNzID0gZnVuY3Rpb24oc2VsZil7XG4gICAgcmV0dXJuIChjYik9PntcbiAgICAgICAgc2VsZlskdHJpZ2dlckxvY2tdID0gdHJ1ZTtcbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGNiPy4oKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHNlbGZbJHRyaWdnZXJMb2NrXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxufVxuXG4vL1xuZXhwb3J0IGNvbnN0IHVud3JhcEFycmF5ID0gKGFycjogYW55W10pPT57XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkge1xuICAgICAgICByZXR1cm4gYXJyPy5mbGF0TWFwPy4oKGVsKT0+e1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZWwpKSByZXR1cm4gdW53cmFwQXJyYXkoZWwpO1xuICAgICAgICAgICAgcmV0dXJuIGVsO1xuICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfVxufVxuXG4vKlxuLy9cbmV4cG9ydCBjb25zdCBpc05vdENvbXBsZXhBcnJheSA9IChhcnI6IGFueVtdKT0+e1xuICAgIHJldHVybiB1bndyYXBBcnJheShhcnIpLmV2ZXJ5KGlzUHJpbWl0aXZlKTtcbn0qL1xuXG4vL1xuZXhwb3J0IGNvbnN0IGlzTm90Q29tcGxleEFycmF5ID0gKGFycjogYW55W10pPT57XG4gICAgcmV0dXJuIHVud3JhcEFycmF5KGFycik/LmV2ZXJ5Py4oaXNDYW5KdXN0UmV0dXJuKTtcbn1cblxuXG4vLyBUT0RPOiByZXZpZXcgY2FzZXMgd2hlbiBhcnJheXMgaXNuJ3QgcHJpbWl0aXZlXG5leHBvcnQgY29uc3QgaXNDYW5KdXN0UmV0dXJuID0gKG9iajogYW55KT0+e1xuICAgIHJldHVybiBpc1ByaW1pdGl2ZShvYmopIHx8ICh0eXBlb2YgU2hhcmVkQXJyYXlCdWZmZXIgPT0gXCJmdW5jdGlvblwiICYmIG9iaiBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyKSB8fCBpc1R5cGVkQXJyYXkob2JqKSB8fCAoQXJyYXkuaXNBcnJheShvYmopICYmIGlzTm90Q29tcGxleEFycmF5KG9iaikpO1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0IGlzVHlwZWRBcnJheSA9ICh2YWx1ZTogYW55KT0+e1xuICAgIHJldHVybiBBcnJheUJ1ZmZlci5pc1ZpZXcodmFsdWUpICYmICEodmFsdWUgaW5zdGFuY2VvZiBEYXRhVmlldyk7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgaXNTeW1ib2wgPSAoc3ltOiB1bmtub3duKSA9PiAodHlwZW9mIHN5bSA9PT0gJ3N5bWJvbCcgfHwgdHlwZW9mIHN5bSA9PSAnb2JqZWN0JyAmJiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc3ltKSA9PSAnW29iamVjdCBTeW1ib2xdJyk7XG5leHBvcnQgY29uc3QgaXNQcm9taXNlID0gPFQgZXh0ZW5kcyBvYmplY3QgfCBGdW5jdGlvbiB8IHVua25vd24+KHRhcmdldDogVCB8IFByb21pc2U8VD4pOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gdGFyZ2V0IGluc3RhbmNlb2YgUHJvbWlzZSB8fCB0eXBlb2YgKHRhcmdldCBhcyBhbnkpPy50aGVuID09IFwiZnVuY3Rpb25cIjtcbn1cblxuLy9cbmV4cG9ydCBjb25zdCBpc0NhblRyYW5zZmVyID0gKG9iajogYW55KT0+e1xuICAgIHJldHVybiBpc1ByaW1pdGl2ZShvYmopIHx8XG4gICAgICAgICh0eXBlb2YgQXJyYXlCdWZmZXIgPT0gXCJmdW5jdGlvblwiICYmIG9iaiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fFxuICAgICAgICAodHlwZW9mIE1lc3NhZ2VQb3J0ID09IFwiZnVuY3Rpb25cIiAmJiBvYmogaW5zdGFuY2VvZiBNZXNzYWdlUG9ydCkgfHxcbiAgICAgICAgKHR5cGVvZiBSZWFkYWJsZVN0cmVhbSA9PSBcImZ1bmN0aW9uXCIgJiYgb2JqIGluc3RhbmNlb2YgUmVhZGFibGVTdHJlYW0pIHx8XG4gICAgICAgICh0eXBlb2YgV3JpdGFibGVTdHJlYW0gPT0gXCJmdW5jdGlvblwiICYmIG9iaiBpbnN0YW5jZW9mIFdyaXRhYmxlU3RyZWFtKSB8fFxuICAgICAgICAodHlwZW9mIFRyYW5zZm9ybVN0cmVhbSA9PSBcImZ1bmN0aW9uXCIgJiYgb2JqIGluc3RhbmNlb2YgVHJhbnNmb3JtU3RyZWFtKSB8fFxuICAgICAgICAodHlwZW9mIEltYWdlQml0bWFwID09IFwiZnVuY3Rpb25cIiAmJiBvYmogaW5zdGFuY2VvZiBJbWFnZUJpdG1hcCkgfHxcbiAgICAgICAgKHR5cGVvZiBWaWRlb0ZyYW1lID09IFwiZnVuY3Rpb25cIiAmJiBvYmogaW5zdGFuY2VvZiBWaWRlb0ZyYW1lKSB8fFxuICAgICAgICAodHlwZW9mIE9mZnNjcmVlbkNhbnZhcyA9PSBcImZ1bmN0aW9uXCIgJiYgb2JqIGluc3RhbmNlb2YgT2Zmc2NyZWVuQ2FudmFzKSB8fFxuICAgICAgICAodHlwZW9mIFJUQ0RhdGFDaGFubmVsID09IFwiZnVuY3Rpb25cIiAmJiBvYmogaW5zdGFuY2VvZiBSVENEYXRhQ2hhbm5lbCkgfHwgLy8gQHRzLWlnbm9yZVxuICAgICAgICAodHlwZW9mIEF1ZGlvRGF0YSA9PSBcImZ1bmN0aW9uXCIgJiYgb2JqIGluc3RhbmNlb2YgQXVkaW9EYXRhKSB8fCAvLyBAdHMtaWdub3JlXG4gICAgICAgICh0eXBlb2YgV2ViVHJhbnNwb3J0UmVjZWl2ZVN0cmVhbSA9PSBcImZ1bmN0aW9uXCIgJiYgb2JqIGluc3RhbmNlb2YgV2ViVHJhbnNwb3J0UmVjZWl2ZVN0cmVhbSkgfHwgLy8gQHRzLWlnbm9yZVxuICAgICAgICAodHlwZW9mIFdlYlRyYW5zcG9ydFNlbmRTdHJlYW0gPT0gXCJmdW5jdGlvblwiICYmIG9iaiBpbnN0YW5jZW9mIFdlYlRyYW5zcG9ydFNlbmRTdHJlYW0pIHx8IC8vIEB0cy1pZ25vcmVcbiAgICAgICAgKHR5cGVvZiBXZWJUcmFuc3BvcnRSZWNlaXZlU3RyZWFtID09IFwiZnVuY3Rpb25cIiAmJiBvYmogaW5zdGFuY2VvZiBXZWJUcmFuc3BvcnRSZWNlaXZlU3RyZWFtKTsgLy8gQHRzLWlnbm9yZVxufVxuXG4vL1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRCeVR5cGUgPSAoYSk9PntcbiAgICBzd2l0Y2godHlwZW9mIGEpIHtcbiAgICAgICAgY2FzZSBcIm51bWJlclwiOiByZXR1cm4gMDtcbiAgICAgICAgY2FzZSBcInN0cmluZ1wiOiByZXR1cm4gXCJcIjtcbiAgICAgICAgY2FzZSBcImJvb2xlYW5cIjogcmV0dXJuIGZhbHNlO1xuICAgICAgICBjYXNlIFwib2JqZWN0XCI6IHJldHVybiBudWxsO1xuICAgICAgICBjYXNlIFwiZnVuY3Rpb25cIjogcmV0dXJuIG51bGw7XG4gICAgICAgIGNhc2UgXCJzeW1ib2xcIjogcmV0dXJuIG51bGw7XG4gICAgICAgIGNhc2UgXCJiaWdpbnRcIjogcmV0dXJuIDBuO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuIl19